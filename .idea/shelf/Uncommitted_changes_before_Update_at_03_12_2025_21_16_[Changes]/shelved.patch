Index: clases/fabrica.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import pyxel\r\nimport random\r\nimport time\r\n\r\nfrom clases.personaje import Personaje\r\nfrom clases.paquetes import Paquetes\r\nfrom clases.camion import Camion\r\n\r\nfrom utils.config import TIEMPO, NUM_CINTAS, cintaPar, COLORES\r\n\r\nclass Fabrica:\r\n    def __init__(self, vidas, POS_PAQ_CIN, NUM_CINTAS):\r\n        self.fallos = 0\r\n        self.pausa = False\r\n        # Cambian en función de la dificultad. DEBUG: Vidas o fallos?\r\n        self.maxFallos = vidas\r\n        self.puntos = 0\r\n        self.tiempoInicial = TIEMPO # tiempo del nivel\r\n        # Guarda el momento en el que se para el tiempo en un fallo. Lo inicializamos a 'TIEMPO'\r\n        self.tiempoPausado = TIEMPO\r\n        self.ultimoSpawn = time.time()\r\n        self.intervalos = [7]  # segundos desde el spawn del ultimo paquete #Con 7 buena experiencia\r\n        self.indiceIntervalo = 0   # Se le pueden poner especies de oleadas cambiando y añadiendo valores en la lista\r\n                                    # (cuando la lista se acaba se repite)\r\n        # self.dificultad = dificultad # 3 tipos\r\n        # DEBUG: En __init__() ???\r\n\r\n        # Inicializamos los personajes\r\n        controlesMario = (pyxel.KEY_UP, pyxel.KEY_DOWN)\r\n        controlesLuigi = (pyxel.KEY_W, pyxel.KEY_S)\r\n        self.luigi = Personaje(\"luigi\", controlesLuigi, 45, 100)\r\n        self.mario = Personaje(\"mario\", controlesMario, 205, 100)\r\n\r\n        self.camion = Camion(10, 30)\r\n        self.paquetes = Paquetes(POS_PAQ_CIN, NUM_CINTAS)\r\n        # Añade un paquete en la posición inicial\r\n        self.paquetes.anadirPaqInicio()\r\n\r\n    @property\r\n    def fallos(self):\r\n        return self.__vidas\r\n\r\n    @fallos.setter\r\n    def fallos(self, valor):\r\n        self.__vidas = valor\r\n\r\n    # @property\r\n    # def tiempoInicial(self):\r\n    #     return self.__tiempoInicial\r\n\r\n    # @tiempoInicial.setter\r\n    # def tiempoInicial(self, valor):\r\n    #     if isinstance(valor, int):\r\n    #         self.__tiempoInicial = valor\r\n    #     else:\r\n    #         raise TypeError(\"El tiempo no es un entero\")\r\n\r\n    @property\r\n    def dificultad(self):\r\n        return self.__dificultad\r\n\r\n    @dificultad.setter\r\n    def dificultad(self, valor):\r\n        self.__dificultad = valor\r\n\r\n    def __repr__(self):\r\n        return f\"Fabrica(vidas={self.fallos}, tiempo={self.tiempoInicial}, dificultad={self.dificultad}\"\r\n\r\n    # Bucle principal del juego\r\n    def juegoRun(self):\r\n        # Mueve todos los objetos (menos los paquetes)\r\n        self.run()\r\n        if not self.pausa:\r\n            # Se mueven los paquetes si el juego no está en pausa\r\n            self.moverPaquetes()\r\n        else:\r\n            # Esperar 't' segundos hasta volver a reanudar el juego\r\n            t = 2\r\n            tiempoActual = time.time()\r\n            tiempoPausado = tiempoActual - self.tiempoPausado\r\n            if tiempoPausado > t:\r\n                self.pausa = False\r\n\r\n    def run(self):\r\n        # Permite mover a los personajes con las teclas\r\n        self.luigi.mover()\r\n        self.mario.mover()\r\n\r\n        # Mover el camión con los paquetes (si está lleno)\r\n        self.camion.mover_y_descargar()\r\n\r\n    def moverPaquetes(self):\r\n        if pyxel.frame_count % 4 == 0:\r\n            self.checkFallo()\r\n            self.paquetes.actualizarPaquetes()\r\n\r\n        # tiempo actual\r\n        ahora = time.time() #tiempo actual, empezado a contar desde que se ejecuta\r\n        intervalo = self.intervalos[self.indiceIntervalo]\r\n        # ¿Ha pasado el tiempo necesario?\r\n        if ahora - self.ultimoSpawn >= intervalo:\r\n            self.paquetes.anadirPaqInicio()\r\n\r\n            # reinicia el temporizador\r\n            self.ultimoSpawn = ahora\r\n            # pasar al siguiente intervalo\r\n            self.indiceIntervalo += 1\r\n            if self.indiceIntervalo == len(self.intervalos):\r\n                self.indiceIntervalo = 0\r\n\r\n    def draw(self, WIDTH, HEIGHT):\r\n        # Muestra los personajes\r\n        self.luigi.draw()\r\n        self.mario.draw()\r\n\r\n        # Muestra las cintas y los paquetes\r\n        self.paquetes.draw()\r\n\r\n        # Muestra el camión\r\n        self.camion.draw()\r\n\r\n        # Muestra el tiempo\r\n        t = time.time()\r\n        tiempo = int((t - self.tiempoInicial) / 1)\r\n        pyxel.text(WIDTH - 20, 5, str(tiempo), COLORES[\"naranja\"])\r\n\r\n        # Muestra los fallos\r\n        pyxel.text(WIDTH - 110, 5, f\"FALLOS: {self.fallos}\", COLORES[\"amarillo\"])\r\n\r\n        # Muesta los puntos\r\n        pyxel.text(60, 5, f\"PUNTOS: {self.puntos}\", COLORES[\"amarillo\"])\r\n\r\n    def anadirFallo(self):\r\n        self.pausa = True\r\n        self.fallos += 1\r\n        self.tiempoPausado = time.time()\r\n\r\n    # Función para ver si se cae un paquete\r\n    # Cuando paquete en el final de las filas pares y no está Luigi, eliminar el paquete. Lo mismo para Mario\r\n    def checkFallo(self):\r\n        x = self.paquetes.longitudX\r\n        for y in range(NUM_CINTAS):\r\n            if y != 0:\r\n                # Comprueba si se cae un paquete en las filas intermedias\r\n                # REFACTOR: Fernando dice que son muchos condicionales y se lee mal\r\n                # QUIZÁS: self.paquetes.paqueteEn(x, y) and cintaIzda() and not self.luigi.enPlanta(y)\r\n                if self.paquetes.matriz[y][0] == 1 and cintaPar(y):\r\n                    if self.luigi.planta != y:  # luigi es el de la izq\r\n                        # pausar juego\r\n                        self.anadirFallo()\r\n                        self.paquetes.matriz[y][0] = 0\r\n                    else:\r\n                        self.puntos += 1\r\n                # if (paquete en el borde dcho) Y (cinta impar) Y (mario no está en esa planta)\r\n                elif self.paquetes.matriz[y][x -1] == 1 and not cintaPar(y):\r\n                    if self.mario.planta != y:\r\n                        self.paquetes.matriz[y][x - 1] = 0\r\n                        self.anadirFallo()\r\n                    else:\r\n                        self.puntos += 1\r\n\r\n                # Comprueba que esté Luigi en la cinta del camión\r\n                if self.paquetes.matriz[0][0] == 1:\r\n                    if self.luigi.planta == 0:\r\n                            self.camion.carga += 1\r\n                            # Controla cuando se llena el camión para pausar el juego\r\n                            if self.camion.carga >= 8:\r\n                                self.pausa = True\r\n                                self.tiempoPausado = time.time()\r\n                                self.puntos += 10\r\n                            # Eliminamos el paquete de la cinta\r\n                            self.paquetes.matriz[0][0] = 0\r\n                    else:\r\n                        self.anadirFallo()\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/clases/fabrica.py b/clases/fabrica.py
--- a/clases/fabrica.py	(revision 5e20b033da8a61a286200fcfd94b5e15f641800f)
+++ b/clases/fabrica.py	(date 1764770656742)
@@ -97,8 +97,10 @@
         # tiempo actual
         ahora = time.time() #tiempo actual, empezado a contar desde que se ejecuta
         intervalo = self.intervalos[self.indiceIntervalo]
+        print("ahora", ahora)
         # ¿Ha pasado el tiempo necesario?
         if ahora - self.ultimoSpawn >= intervalo:
+            print("resta", ahora - self.ultimoSpawn)
             self.paquetes.anadirPaqInicio()
 
             # reinicia el temporizador
Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"Black\">\r\n    <option name=\"sdkName\" value=\"Python 3.12\" />\r\n  </component>\r\n  <component name=\"ProjectRootManager\" version=\"2\" project-jdk-name=\"Python 3.12\" project-jdk-type=\"Python SDK\" />\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/misc.xml b/.idea/misc.xml
--- a/.idea/misc.xml	(revision 5e20b033da8a61a286200fcfd94b5e15f641800f)
+++ b/.idea/misc.xml	(date 1764766349894)
@@ -3,5 +3,5 @@
   <component name="Black">
     <option name="sdkName" value="Python 3.12" />
   </component>
-  <component name="ProjectRootManager" version="2" project-jdk-name="Python 3.12" project-jdk-type="Python SDK" />
+  <component name="ProjectRootManager" version="2" project-jdk-name="Python 3.14 (mario-bros3)" project-jdk-type="Python SDK" />
 </project>
\ No newline at end of file
Index: .idea/Sprint 1B.iml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<module type=\"PYTHON_MODULE\" version=\"4\">\r\n  <component name=\"NewModuleRootManager\">\r\n    <content url=\"file://$MODULE_DIR$\">\r\n      <excludeFolder url=\"file://$MODULE_DIR$/.venv\" />\r\n    </content>\r\n    <orderEntry type=\"jdk\" jdkName=\"Python 3.12\" jdkType=\"Python SDK\" />\r\n    <orderEntry type=\"sourceFolder\" forTests=\"false\" />\r\n  </component>\r\n  <component name=\"PyDocumentationSettings\">\r\n    <option name=\"format\" value=\"PLAIN\" />\r\n    <option name=\"myDocStringFormat\" value=\"Plain\" />\r\n  </component>\r\n</module>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/Sprint 1B.iml b/.idea/Sprint 1B.iml
--- a/.idea/Sprint 1B.iml	(revision 5e20b033da8a61a286200fcfd94b5e15f641800f)
+++ b/.idea/Sprint 1B.iml	(date 1764766349880)
@@ -4,7 +4,7 @@
     <content url="file://$MODULE_DIR$">
       <excludeFolder url="file://$MODULE_DIR$/.venv" />
     </content>
-    <orderEntry type="jdk" jdkName="Python 3.12" jdkType="Python SDK" />
+    <orderEntry type="jdk" jdkName="Python 3.14 (mario-bros3)" jdkType="Python SDK" />
     <orderEntry type="sourceFolder" forTests="false" />
   </component>
   <component name="PyDocumentationSettings">
